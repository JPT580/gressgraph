digraph firajawall {
  graph [bgcolor="#808080" ranksep=3]

  // Invisible root node
  rootNode [root=true, style=invis]

  { rank=same
  "any" [label="any" height=2 width=2]
  "eth0" [label="eth0"]
  "eth1" [label="eth1"]
  "ath0" [label="ath0"]
  "lo" [label="lo"]
  }

"any" -> rootNode [style=invis]
"eth0" -> rootNode [style=invis]
"eth1" -> rootNode [style=invis]
"ath0" -> rootNode [style=invis]
"lo" -> rootNode [style=invis]

  { rank=same
  // Addresses
  "any_anywhere" [label="anywhere" height=2 width=2]
  "ath0_anywhere" [label="anywhere"]
  "eth0_anywhere" [label="anywhere"]
  "eth1_anywhere" [label="anywhere"]
  "lo_anywhere" [label="anywhere"]
  "eth0_10.0.0.0/8" [label="10.0.0.0/8"]
  "eth0_172.16.0.0/255.250.0.0" [label="172.16.0.0/255.250.0.0"]
  "eth0_192.168.0.0/16" [label="192.168.0.0/16"]
  "ath0_carrie" [label="carrie"]
  "ath0_malglata" [label="malglata"]
  "ath0_necesiga" [label="necesiga"]
  }

  // Rules
  edge [color="#0000FF", fontcolor="#0000FF"]
  "any_anywhere" -> "any" [label="INVALID"]
  "any" -> "any" -> "any_anywhere" [style=dashed fillcolor="#808080"]

  edge [color="#00FFFF", fontcolor="#00FFFF"]
  "eth0_172.16.0.0/255.250.0.0" -> "eth0"
  "eth0" -> "any" -> "any_anywhere" [style=dashed]
  
  edge [color="#00FF00", fontcolor="#00FF00"]
  "eth0_10.0.0.0/8" -> "eth0"
  "eth0" -> "any" -> "any_anywhere" [style=dashed]

  edge [color="#FF0000", fontcolor="#FF0000"]
  "ath0_anywhere" -> "ath0" [label="tcp:microsoft-ds"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#FFFF00", fontcolor="#FFFF00"]
  "eth0_192.168.0.0/16" -> "eth0"
  "eth0" -> "any" -> "any_anywhere" [style=dashed]

  edge [color="#FF00FF", fontcolor="#FF00FF"]
  "any_anywhere" -> "any" [label="RELATED,ESTABLISHED"]
  "any" -> "any" -> "any_anywhere"

  edge [color="#0000FF", fontcolor="#0000FF"]
  "ath0_anywhere" -> "ath0" [label="udp:bootps"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#00FF00", fontcolor="#00FF00"]
  "lo_anywhere" -> "lo"
  "lo" -> "any" -> "any_anywhere"

  edge [color="#FF0000", fontcolor="#FF0000"]
  "any_anywhere" -> "any" [label="tcp:ssh NEW"]
  "any" -> "any" -> "any_anywhere"

  edge [color="#00FFFF", fontcolor="#00FFFF"]
  "ath0_anywhere" -> "ath0" [label="udp:bootps"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#FFFF00", fontcolor="#FFFF00"]
  "ath0_anywhere" -> "ath0" [label="tcp:netbios-ssn"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#FF00FF", fontcolor="#FF00FF"]
  "ath0_anywhere" -> "ath0" [label="tcp:domain"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#0000FF", fontcolor="#0000FF"]
  "ath0_anywhere" -> "ath0" [label="udp:domain"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#00FF00", fontcolor="#00FF00"]
  "ath0_anywhere" -> "ath0" [label="udp:ntp"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#FF0000", fontcolor="#FF0000"]
  "eth0_anywhere" -> "eth0" [label="tcp:10001-10010"]
  "eth0" -> "any" -> "any_anywhere"

  edge [color="#00FFFF", fontcolor="#00FFFF"]
  "ath0_carrie" -> "ath0" [label="tcp:ipp NEW"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#FFFF00", fontcolor="#FFFF00"]
  "eth0_anywhere" -> "eth0" [label="udp:ntp"]
  "eth0" -> "any" -> "any_anywhere"

  edge [color="#0000FF", fontcolor="#0000FF"]
  "eth1_anywhere" -> "eth1" [label="udp:bootps"]
  "eth1" -> "any" -> "any_anywhere"

  edge [color="#00FF00", fontcolor="#00FF00"]
  "eth1_anywhere" -> "eth1" [label="udp:domain"]
  "eth1" -> "any" -> "any_anywhere"

  edge [color="#FF0000", fontcolor="#FF0000"]
  "eth1_anywhere" -> "eth1" [label="tcp:domain"]
  "eth1" -> "any" -> "any_anywhere"

  edge [color="#00FFFF", fontcolor="#00FFFF"]
  "ath0_malglata" -> "ath0" [label="udp:ntp"]
  "ath0" -> "any" -> "any_anywhere"

  edge [color="#0000FF", fontcolor="#0000FF"]
  "any_anywhere" -> "any" [label="NEW,RELATED,ESTABLISHED"]
  "any" -> "any" -> "any_anywhere"

  edge [color="#00FF00", fontcolor="#00FF00"]
  "ath0_anywhere" -> "ath0"
  "ath0" -> "eth0" -> "eth0_anywhere"

  edge [color="#FF0000", fontcolor="#FF0000"]
  "eth1_anywhere" -> "eth1"
  "eth1" -> "eth0" -> "eth0_anywhere"

  edge [color="#FF00FF", fontcolor="#FF00FF"]
  "ath0_anywhere" -> "ath0"
  "ath0" -> "ath0" -> "ath0_carrie"

  edge [color="#FFFF00", fontcolor="#FFFF00"]
  "ath0_anywhere" -> "ath0"
  "ath0" -> "ath0" -> "ath0_necesiga"

  edge [color="#00FFFF", fontcolor="#00FFFF"]
  "ath0_anywhere" -> "ath0"
  "ath0" -> "ath0" -> "ath0_malglata"
}